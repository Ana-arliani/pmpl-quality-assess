<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form Penilaian Kualitas | QualityAssess</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .radio-group {
        display: flex;
        gap: 0.5rem;
      }
      .radio-group input[type="radio"] {
        display: none;
      }
      .radio-group label {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        width: 6rem; /* Adjusted width for text */
        height: 2.5rem;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        font-weight: 600;
        cursor: pointer;
        color: #374151;
        background-color: #fff;
      }
      .radio-group input[type="radio"]:checked + label {
        background-color: #3b82f6;
        border-color: #2563eb;
        color: white;
      }
      textarea {
        resize: vertical;
      }
    </style>
  </head>
  <body class="bg-gray-50 font-sans">
    <header class="bg-white shadow sticky top-0 z-10">
      <nav class="max-w-7xl mx-auto px-4 py-4 flex justify-between">
        <a href="#" class="text-xl font-bold text-blue-600"
          >QualityAssess Tugas PMPL Ana</a
        >
        <div class="space-x-4 text-sm">
          <a href="index.html" class="hover:text-blue-600">Beranda</a>
          <a href="penilaian.html" class="text-blue-600 font-semibold"
            >Penilaian</a
          >
          <a href="laporan.html" class="hover:text-blue-600">Laporan</a>
          <a href="tentang.html" class="hover:text-blue-600">Tentang</a>
        </div>
      </nav>
    </header>

    <main class="max-w-4xl mx-auto px-6 py-10">
      <h1 class="text-2xl font-bold mb-6 text-gray-800">
        Form Penilaian Kualitas Perangkat Lunak (ISO 9126)
      </h1>
      <form id="form-penilaian" class="space-y-6">
        <div class="grid sm:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-1" for="namaProyek"
              >Nama Proyek</label
            >
            <input
              id="namaProyek"
              required
              class="w-full border rounded px-3 py-2"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1" for="versi"
              >Versi</label
            >
            <input
              id="versi"
              required
              class="w-full border rounded px-3 py-2"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1" for="namaPenilai"
              >Nama Penilai</label
            >
            <input
              id="namaPenilai"
              required
              class="w-full border rounded px-3 py-2"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1" for="tanggalPenilaian"
              >Tanggal Penilaian</label
            >
            <input
              type="date"
              id="tanggalPenilaian"
              required
              class="w-full border rounded px-3 py-2"
            />
          </div>
        </div>

        <div id="sectionContainer"></div>

        <div>
          <label class="block text-sm font-semibold mb-1">Total Skor</label>
          <input
            id="totalSkor"
            readonly
            class="w-full bg-gray-100 border rounded px-3 py-2"
          />
        </div>

        <div>
          <label class="block text-sm font-semibold mb-1">Interpretasi</label>
          <input
            id="interpretasi"
            readonly
            class="w-full bg-gray-100 border rounded px-3 py-2"
          />
        </div>

        <div>
          <label class="block text-sm font-semibold mb-1">Kesimpulan</label>
          <textarea
            id="kesimpulan"
            rows="3"
            class="w-full border rounded p-2"
          ></textarea>
        </div>

        <div>
          <label class="block text-sm font-semibold mb-1">Rekomendasi</label>
          <textarea
            id="rekomendasi"
            rows="3"
            class="w-full border rounded p-2"
          ></textarea>
        </div>

        <div class="text-right">
          <button
            type="submit"
            class="bg-blue-600 text-white font-semibold px-6 py-2 rounded hover:bg-blue-700"
          >
            Kirim Penilaian
          </button>
        </div>
      </form>
    </main>

    <script>
      const struktur = {
        Fungsionalitas: [
          {
            nama: "Kesesuaian",
            bobot: 5,
            deskripsi:
              "Apakah fungsi yang disediakan sesuai dengan kebutuhan pengguna?",
          },
          {
            nama: "Akurasi",
            bobot: 5,
            deskripsi: "Apakah hasil dari fungsi yang dijalankan akurat?",
          },
          {
            nama: "Interoperabilitas",
            bobot: 5,
            deskripsi:
              "Apakah sistem dapat berinteraksi dengan sistem atau aplikasi lain?",
          },
          {
            nama: "Kepatuhan",
            bobot: 5,
            deskripsi: "Apakah sistem mematuhi standar atau regulasi industri?",
          },
          {
            nama: "Keamanan",
            bobot: 5,
            deskripsi: "Apakah sistem aman dari akses yang tidak sah?",
          },
        ],
        Keandalan: [
          {
            nama: "Kematangan",
            bobot: 7,
            deskripsi:
              "Apakah sistem jarang mengalami kegagalan saat dijalankan?",
          },
          {
            nama: "Toleransi kesalahan",
            bobot: 7,
            deskripsi:
              "Apakah sistem tetap berjalan saat terjadi gangguan kecil?",
          },
          {
            nama: "Pemulihan",
            bobot: 6,
            deskripsi: "Apakah sistem dapat pulih dengan cepat dari gangguan?",
          },
        ],
        Kegunaan: [
          {
            nama: "Dapat dimengerti",
            bobot: 5,
            deskripsi: "Apakah pengguna mudah memahami cara kerja sistem?",
          },
          {
            nama: "Kemudahan dipelajari",
            bobot: 5,
            deskripsi: "Apakah sistem mudah dipelajari oleh pengguna baru?",
          },
          {
            nama: "Kemudahan dioperasikan",
            bobot: 5,
            deskripsi: "Apakah sistem mudah digunakan dalam berbagai kondisi?",
          },
        ],
        Efisiensi: [
          {
            nama: "Perilaku waktu",
            bobot: 5,
            deskripsi: "Apakah sistem merespon dengan cepat?",
          },
          {
            nama: "Perilaku sumber daya",
            bobot: 5,
            deskripsi:
              "Apakah penggunaan sumber daya sistem efisien (CPU, memori, bandwidth)?",
          },
        ],
        Pemeliharaan: [
          {
            nama: "Kemudahan analisis",
            bobot: 5,
            deskripsi:
              "Apakah mudah menemukan akar masalah saat terjadi kegagalan?",
          },
          {
            nama: "Kemudahan perubahan",
            bobot: 5,
            deskripsi: "Apakah sistem mudah diperbarui atau dimodifikasi?",
          },
          {
            nama: "Stabilitas",
            bobot: 5,
            deskripsi:
              "Apakah sistem tetap stabil setelah dilakukan perubahan?",
          },
          {
            nama: "Kemudahan pengujian",
            bobot: 5,
            deskripsi: "Apakah sistem mudah diuji setelah diubah?",
          },
        ],
        Portabilitas: [
          {
            nama: "Kemampuan beradaptasi",
            bobot: 3,
            deskripsi:
              "Apakah sistem dapat berjalan di berbagai lingkungan/platform?",
          },
          {
            nama: "Kemudahan instalasi",
            bobot: 3,
            deskripsi: "Apakah sistem mudah dipasang?",
          },
          {
            nama: "Kepatuhan portabilitas",
            bobot: 2,
            deskripsi: "Apakah sistem memenuhi standar portabilitas?",
          },
          {
            nama: "Kemudahan penggantian",
            bobot: 2,
            deskripsi: "Apakah komponen sistem dapat diganti dengan mudah?",
          },
        ],
      };

      const sectionContainer = document.getElementById("sectionContainer");

      Object.entries(struktur).forEach(([judul, subkriterias]) => {
        const section = document.createElement("section");
        section.className = "mb-8";
        section.innerHTML = `<h2 class='text-lg font-semibold mb-4 border-b pb-1'>${judul}</h2>`;

        subkriterias.forEach(({ nama, bobot, deskripsi }) => {
          const id = nama.toLowerCase().replace(/\s+/g, "_");
          const field = document.createElement("div");
          field.className = "mb-6";
          field.innerHTML = `
          <label class="block mb-1 font-medium text-gray-800">${nama} <span class="text-sm text-gray-500">(Bobot: ${bobot})</span></label>
          <p class="text-sm text-gray-600 mb-2 italic">${deskripsi}</p>
          <div class="radio-group mb-2">
            ${["Sangat Buruk", "Buruk", "Cukup", "Baik", "Sangat Baik"]
              .map(
                (v, index) => `
              <input type="radio" id="${id}-${index + 1}" name="${id}" value="${
                  index + 1
                }" required>
              <label for="${id}-${index + 1}">${v}</label>
            `
              )
              .join("")}
          </div>
          <textarea name="komentar_${id}" placeholder="Komentar..." class="w-full rounded border border-gray-300 p-2"></textarea>
        `;
          section.appendChild(field);
        });

        sectionContainer.appendChild(section);
      });

      function hitungSkor(data) {
        let total = 0;
        Object.entries(struktur).forEach(([_, subkriterias]) => {
          subkriterias.forEach(({ nama, bobot }) => {
            const id = nama.toLowerCase().replace(/\s+/g, "_");
            const nilai = parseInt(data.penilaian[id] || 0);
            total += nilai * bobot;
          });
        });
        return total;
      }

      function interpretasiSkor(total) {
        if (total >= 425) return "Sangat Baik";
        if (total >= 350) return "Baik";
        if (total >= 275) return "Cukup";
        if (total >= 200) return "Buruk";
        return "Sangat Buruk";
      }

      document.querySelector("form").addEventListener("submit", function (e) {
        e.preventDefault();
        const form = e.target;
        const data = {
          namaProyek: form.namaProyek.value,
          versi: form.versi.value,
          namaPenilai: form.namaPenilai.value,
          tanggalPenilaian: form.tanggalPenilaian.value,
          kesimpulan: form.kesimpulan.value,
          rekomendasi: form.rekomendasi.value,
          penilaian: {},
          komentar: {},
        };

        Object.entries(struktur).forEach(([_, subkriterias]) => {
          subkriterias.forEach(({ nama }) => {
            const id = nama.toLowerCase().replace(/\s+/g, "_");
            data.penilaian[id] = form[id].value;
            data.komentar[id] = form[`komentar_${id}`].value;
          });
        });

        const totalSkor = hitungSkor(data);
        const interpretasi = interpretasiSkor(totalSkor);
        data.totalSkor = totalSkor;
        data.interpretasi = interpretasi;

        document.getElementById("totalSkor").value = totalSkor;
        document.getElementById("interpretasi").value = interpretasi;

        const laporan = JSON.parse(localStorage.getItem("laporan") || "[]");
        const editIndex = sessionStorage.getItem("editIndex");

        if (editIndex !== null) {
          laporan[editIndex] = data;
          sessionStorage.removeItem("editIndex");
          sessionStorage.removeItem("editData");
        } else {
          laporan.push(data);
        }

        localStorage.setItem("laporan", JSON.stringify(laporan));
        alert("Penilaian berhasil disimpan!");
        window.location.href = "laporan.html";
      });

      window.addEventListener("DOMContentLoaded", () => {
        const editData = sessionStorage.getItem("editData");
        if (editData) {
          const data = JSON.parse(editData);
          document.getElementById("namaProyek").value = data.namaProyek;
          document.getElementById("versi").value = data.versi;
          document.getElementById("namaPenilai").value = data.namaPenilai;
          document.getElementById("tanggalPenilaian").value =
            data.tanggalPenilaian;
          document.getElementById("kesimpulan").value = data.kesimpulan;
          document.getElementById("rekomendasi").value = data.rekomendasi;

          Object.entries(data.penilaian).forEach(([key, val]) => {
            const radio = document.querySelector(
              `input[name='${key}'][value='${val}']`
            );
            if (radio) radio.checked = true;
          });

          Object.entries(data.komentar).forEach(([key, val]) => {
            const textarea = document.querySelector(
              `textarea[name='komentar_${key}']`
            );
            if (textarea) textarea.value = val;
          });

          document.getElementById("totalSkor").value = data.totalSkor;
          document.getElementById("interpretasi").value = data.interpretasi;
        }
      });
    </script>
  </body>
</html>
\end{code}
